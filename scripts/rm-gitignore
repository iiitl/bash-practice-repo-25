#!/usr/bin/env bash

# Removes all files written in .gitignore of any git repository (multiple) present inside current directory
# To find list of all git repos inside current directory you can use: "find . -name .git -type d -prune"
if ! git rev-parse --is-inside-work-tree &>/dev/null; then
  echo "âŒ Error: Not inside a Git repository!"
  exit 1
fi

# Preview files that will be removed
echo "ğŸš€ Previewing files that will be removed..."
git clean -ndX  # -n (dry run), -d (directories), -X (ignored files only)

# Ask for confirmation
read -p "âš ï¸ Are you sure you want to delete these files? (y/N) " confirm
if [[ "$confirm" != "y" && "$confirm" != "Y" ]]; then
  echo "âŒ Operation canceled."
  exit 0
fi

# Remove ignored files
echo "ğŸ—‘ï¸ Removing ignored files..."
git clean -fdX  # -f (force), -d (directories), -X (ignored files only)

echo "âœ… Cleanup complete!"
